/home/jay/miniconda3/envs/venv_jaxfluids/lib/python3.11/site-packages/jaxfluids/input/input_manager.py:161: RuntimeWarning: Active levelset and mesh stretching requires the user to ensure that the interface is located on the highest resolution with cell size aspect ratio unity.
  warnings.warn(warning_string, RuntimeWarning)
Using cuda device
Wrapping the env with a `Monitor` wrapper
Wrapping the env in a DummyVecEnv.
/home/jay/miniconda3/envs/venv_jaxfluids/lib/python3.11/site-packages/jaxfluids/initialization/forcings_initializer.py:84: RuntimeWarning: Restart file /home/jay/jaxfluids_rl/src/jaxfluids_rl/envs/cylinder2D/restart_files/data_1050.0096224507.h5 does not contain forcings, however, there are active forcings. Using default values
  warnings.warn(warning_string, RuntimeWarning)
Traceback (most recent call last):
  File "/home/jay/FNO_RL/test.py", line 130, in <module>
    model.learn(total_timesteps=100000,callback=callback_list)
  File "/home/jay/miniconda3/envs/venv_jaxfluids/lib/python3.11/site-packages/stable_baselines3/ppo/ppo.py", line 311, in learn
    return super().learn(
           ^^^^^^^^^^^^^^
  File "/home/jay/miniconda3/envs/venv_jaxfluids/lib/python3.11/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 323, in learn
    continue_training = self.collect_rollouts(self.env, callback, self.rollout_buffer, n_rollout_steps=self.n_steps)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jay/miniconda3/envs/venv_jaxfluids/lib/python3.11/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 218, in collect_rollouts
    new_obs, rewards, dones, infos = env.step(clipped_actions)
                                     ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jay/miniconda3/envs/venv_jaxfluids/lib/python3.11/site-packages/stable_baselines3/common/vec_env/base_vec_env.py", line 207, in step
    return self.step_wait()
           ^^^^^^^^^^^^^^^^
  File "/home/jay/miniconda3/envs/venv_jaxfluids/lib/python3.11/site-packages/stable_baselines3/common/vec_env/dummy_vec_env.py", line 59, in step_wait
    obs, self.buf_rews[env_idx], terminated, truncated, self.buf_infos[env_idx] = self.envs[env_idx].step(  # type: ignore[assignment]
                                                                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jay/miniconda3/envs/venv_jaxfluids/lib/python3.11/site-packages/stable_baselines3/common/monitor.py", line 94, in step
    observation, reward, terminated, truncated, info = self.env.step(action)
                                                       ^^^^^^^^^^^^^^^^^^^^^
  File "/home/jay/jaxfluids_rl/src/jaxfluids_rl/envs/cylinder2D/cylinder2D.py", line 185, in step
    jxf_buffers, cb_buffers = self.advance_fn(
                              ^^^^^^^^^^^^^^^^
  File "/home/jay/jaxfluids_rl/src/jaxfluids_rl/helper_functions.py", line 86, in advance
    wall_clock_times = self.compute_wall_clock_time(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jay/miniconda3/envs/venv_jaxfluids/lib/python3.11/site-packages/jaxfluids/simulation_manager.py", line 449, in compute_wall_clock_time
    mean_wall_clock_step = (wall_clock_step + mean_wall_clock_step * (simulation_step - offset)) / (simulation_step - offset + 1)
                                                                                                    ~~~~~~~~~~~~~~~~^~~~~~~~
  File "/home/jay/miniconda3/envs/venv_jaxfluids/lib/python3.11/site-packages/jax/_src/numpy/array_methods.py", line 579, in deferring_binary_op
    return binary_op(*args)
           ^^^^^^^^^^^^^^^^
  File "/home/jay/miniconda3/envs/venv_jaxfluids/lib/python3.11/site-packages/jax/_src/numpy/ufunc_api.py", line 174, in __call__
    check_arraylike(self.__name__, *args)
  File "/home/jay/miniconda3/envs/venv_jaxfluids/lib/python3.11/site-packages/jax/_src/numpy/util.py", line 171, in check_arraylike
    if any(not _arraylike(arg) for arg in args):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jay/miniconda3/envs/venv_jaxfluids/lib/python3.11/site-packages/jax/_src/numpy/util.py", line 171, in <genexpr>
    if any(not _arraylike(arg) for arg in args):
               ^^^^^^^^^^^^^^^
  File "/home/jay/miniconda3/envs/venv_jaxfluids/lib/python3.11/site-packages/jax/_src/numpy/util.py", line 130, in _arraylike
    return (isinstance(x, np.ndarray) or isinstance(x, Array) or
                                         ^^^^^^^^^^^^^^^^^^^^
  File "<frozen abc>", line 119, in __instancecheck__
  File "<frozen abc>", line 123, in __subclasscheck__
KeyboardInterrupt
